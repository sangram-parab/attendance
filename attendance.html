<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Attendance — Subject</title>

  <style>
    body{
      font-family:Poppins,Inter,sans-serif;
      margin:0; padding:28px;
      background:#eef6ff;
      color:#07304f;
    }

    .card{
      max-width:900px;
      margin:18px auto;
      background:white;
      padding:22px;
      border-radius:14px;
      box-shadow:0 10px 30px rgba(0,0,0,0.06);
    }

    /* Top Header */
    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:18px;
    }
    .btn-small{
      padding:8px 14px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }
    .back-btn{
      background:#dfe6ea;
    }
    .defaulter-btn{
      background:#e53935;
      color:#fff;
    }

    h1{ margin:0; font-size:22px; }
    .meta{ color:#234a6f; font-size:14px; margin-bottom:12px; }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }

    th{
      text-align:left;
      padding:12px;
      background:#f1f5fa;
      border-bottom:1px solid #d8e1eb;
      font-size:15px;
    }

    td{
      padding:12px;
      border-bottom:1px solid #eef2f7;
      font-size:15px;
    }

    /* ---------- RADIO BUTTON STYLING ---------- */
    .choice-box{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 14px;
      border:1px solid #cfd8e3;
      border-radius:25px;
      cursor:pointer;
      transition:0.2s;
      user-select:none;
    }

    .choice-box:hover{
      background:#e9f3ff;
      transform:scale(1.03);
    }

    .choice-box input{
      transform:scale(1.4);
      cursor:pointer;
    }

    /* Present color */
    .present:hover{
      background:#d8f6e3;
      border-color:#52b36d;
    }

    /* Absent color */
    .absent:hover{
      background:#ffe1e1;
      border-color:#f05959;
    }

    /* Main Submit Button */
    .btn{
      padding:12px 20px;
      border-radius:10px;
      border:none; cursor:pointer;
      font-weight:700;
      background:#2e7d32;
      color:#fff;
      margin-top:22px;
      display:block;
      margin-left:auto; margin-right:auto;
      font-size:16px;
    }

    .btn:hover{
      background:#256628;
      transform:scale(1.02);
      transition:0.2s;
    }
  </style>
</head>
<body>

  <div class="card">

    <div class="topbar">
      <button class="btn-small back-btn" onclick="history.back()">⬅ Back</button>
      <h1 id="title">Attendance</h1>
      <button class="btn-small defaulter-btn" onclick="openDefaulterList()">Defaulter List</button>
    </div>

    <div class="meta" id="meta">Subject: — | Teacher: —</div>

    <table>
      <thead>
        <tr>
          <th>Roll</th>
          <th>Name</th>
          <th>Present</th>
          <th>Absent</th>
        </tr>
      </thead>
      <tbody id="studentList"></tbody>
    </table>

    <button class="btn" id="submitAttendance">Submit Attendance</button>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const subject = params.get('sub') || 'Unknown Subject';
    const teacher = params.get('teacher') || 'Unknown Teacher';

    document.getElementById('title').innerText = `${subject} — Attendance`;
    document.getElementById('meta').innerText = `Subject: ${subject}  |  Teacher: ${teacher}`;

    function openDefaulterList(){
      window.location.href =
        "defaulter.html?sub=" + encodeURIComponent(subject) +
        "&teacher=" + encodeURIComponent(teacher);
    }

    const students = [
      { roll:6202, name:"Sangram" },
      { roll:6203, name:"Nitesh" },
      { roll:6204, name:"Anurang" },
      { roll:6205, name:"Neeraj" },
      { roll:6206, name:"Suraj" },
      { roll:6207, name:"Yash" },
      { roll:6208, name:"Omkar" },
      { roll:6209, name:"Sujal" },
      { roll:6210, name:"Raj" },
      { roll:6211, name:"Pranjal" },
      { roll:6212, name:"Vibhor" },
      { roll:6213, name:"Gautam" },
      { roll:6214, name:"Mrunal" }
    ];

    const tbody = document.getElementById("studentList");

    students.forEach(s => {
      const row = document.createElement("tr");

      row.innerHTML = `
        <td>${s.roll}</td>
        <td>${s.name}</td>

        <td>
          <label class="choice-box present">
            <input type="radio" name="att_${s.roll}" value="Present">
            Present
          </label>
        </td>

        <td>
          <label class="choice-box absent">
            <input type="radio" name="att_${s.roll}" value="Absent">
            Absent
          </label>
        </td>
      `;

      tbody.appendChild(row);
    });

    document.getElementById("submitAttendance").onclick = () => {
      const today = new Date().toLocaleDateString('en-IN');
      const key = `attendance::${subject}::${today}`;
      const records = [];

      students.forEach(s => {
        const selected = document.querySelector(`input[name=att_${s.roll}]:checked`);
        if(selected){
          records.push({
            roll:s.roll, name:s.name,
            subject, teacher,
            date:today,
            status:selected.value
          });
        }
      });

      localStorage.setItem(key, JSON.stringify(records));
      alert("Attendance saved.");
    };
  </script>

</body>
</html>
