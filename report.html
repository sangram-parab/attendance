<script>
  function loadStudentReport() {
    const roll = document.getElementById("rollInput").value.trim();

    const table = document.getElementById("studentTable");
    const tbody = table.querySelector("tbody");
    const noData = document.getElementById("noData");

    tbody.innerHTML = "";
    table.style.display = "none";
    noData.style.display = "none";

    if (!roll) {
      alert("Please enter roll number.");
      return;
    }

    let allRecords = [];

    // Read all attendance::* keys
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);

      if (key.startsWith("attendance::")) {
        const data = JSON.parse(localStorage.getItem(key)) || [];
        allRecords = allRecords.concat(data);
      }
    }

    const studentRecords = allRecords.filter(r => r.roll == roll);

    if (studentRecords.length === 0) {
      noData.style.display = "block";
      return;
    }

    studentRecords.forEach(r => {
      let row = `
        <tr>
          <td>${r.name}</td>
          <td>${r.roll}</td>
          <td>${r.subject}</td>
          <td>${r.date}</td>
          <td>${r.status}</td>
        </tr>
      `;
      tbody.innerHTML += row;
    });

    table.style.display = "table";
  }
</script>
